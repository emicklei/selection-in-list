<html>
    <head>
        <style>
.column {
    float: left;
    width: 200px; 
    display:block;
    height: 250px;
    overflow:scroll;
}

/* Clear floats after the columns */
.row:after {
    content: "";
    display: table;
    clear: both;
}

selection-in-list.no-bullets {
  list-style-type: none; /* Remove bullets */
  padding: 0; /* Remove padding */
  margin: 0; /* Remove margins */
}

a {
    text-decoration: none;
    margin-left: 5px;
}

a.selected {
    color: yellow;
}

/* full width background of list item */
.selected {
    display: block;
    background-color: black;    
    width: 100%;
}
        </style>
    </head>    
    <body>
        <script>
            class SelectionInList extends HTMLElement {
                constructor() {
                    // Always call super first in constructor
                    super();
                    this.selectionEventHandler = null;
                    this.lastSelected = null;                    
                } 
                getSelected() { return this.lastSelected; }
                setSelected(what) { this.lastSelected = what; }

                addItem(label,value) {
                    let li = document.createElement('li');
                    let an = document.createElement('a');
                    an.setAttribute('data-value',value);
                    an.setAttribute('href','#');
                    an.setAttribute('onmouseup','javascript:select(this);');
                    an.textContent = label;
                    li.appendChild(an);
                    this.appendChild(li);
                }
                clearItems() {
                    this.replaceChildren();
                }
                select(me) {
                    if (this.getSelected() !== null) { 
                        // list element
                        this.getSelected().parentNode.classList.remove('selected');
                        // anchor element
                        this.getSelected().classList.remove('selected');    
                    }
                    if (me === this.getSelected()) {
                        this.setSelected(null);
                        this.dispatchEvent(new Event('selection',{detail: null}));
                        return;
                    }
                    // list element
                    me.parentNode.classList.add('selected');
                    // anchor element
                    me.classList.add('selected');
                    this.setSelected(me);
                    this.dispatchEvent(new CustomEvent('selection',{detail: me.getAttribute('data-value')}));
                }
            }
            // https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry/define#examples
            customElements.define('selection-in-list', SelectionInList);

            // TODO how to skip this indirection?
            function select(me) {               
                me.parentNode.parentNode.select(me);
            }
            // TODO how to get this behaviour in the class?
            function keydown(event){
                if (event.code == 'ArrowUp') {
                    console.log(event);
                    event.preventDefault();
                }
            }
        </script>         
            <div class="row">
                <div class="column">
                    <selection-in-list id="list1" class="no-bullets" onkeydown="javascript:keydown(event);" /><!-- in constructor? -->
                </div>
 
                <div class="column">
                    <selection-in-list id="list2" class="no-bullets" />
                </div>
            </div>
        <script>
            let list1 = document.querySelector('#list1');
            for (let i = 0; i < 30; i++) {
                list1.addItem('click me '+i,'click me '+i);
            }
            list1.addEventListener('selection', function(which) {
                console.log('list1:', which.detail);
            });

            let list2 = document.querySelector('#list2');
            for (let i = 0; i < 30; i++) {
                list2.addItem('select me '+i,'select me '+i);
            }
            //list2.clearItems();            
            list2.addEventListener('selection', function(which) {
                console.log('list2:', which.detail);
            });
        </script>
    </body>
</html>
